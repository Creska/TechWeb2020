<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
  <script type="text/javascript" src="editor.js"></script>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <link rel="stylesheet" href="editor.css">

  <title>Editor</title>
</head>
<body>
  <!--
    TASTI DI INTERFACCIA
    "Salva" -> Salva su server. Il campo "nome" è già compilato se il JSON esiste già. Nel caso venga cambiato, viene creato un nuovo JSON
    "Indietro" -> Torna alla sezione precedente chiedendo se si vuole salvare il lavoro effettuato
    "Chiudi" -> Torna al menu principale mostrando il widget che chiede se si vuole salvare
  -->
  <div class="btn-group btn-group-lg" id="EditorNavbar" role="group" aria-label="...">
    <!-- aggiungere icone di FontAwesome -->
    <!-- aggiungere metodo per rendere i pulsanti non cliccabili in determinate situazioni -->
    <button type="button" class="btn btn-secondary" onclick="goBack();">Back</button>
    <button type="button" class="btn btn-secondary">Save</button>
    <button type="button" class="btn btn-secondary" onclick="printCurrentJson();">Close</button>
  </div>


  <!-- MENU PRINCIPALE -->
  <div class="EditorSection" id="MainMenu">
    <div>
      Clicca su una delle opzioni per partire
    </div>
    <!-- MainButtonGroup = gruppo di pulsanti grandi -->
    <div class="MainButtonGroup" id="MainMenuButtonGroup">
      <button class="btn btn-primary btn-lg btn-block" onclick="goToSection('ChooseGameMode');"><strong>NEW</strong><br>Crea una nuova storia</button>
      <button class="btn btn-primary btn-lg btn-block" onclick="goToSection('ChooseStoryToEdit');"><strong>EDIT</strong><br>Modifica una storia // TODO</button>
      <button class="btn btn-primary btn-lg btn-block" onclick="goToSection('Explorer');"><strong>SERVER</strong><br>Gestisci le storie salvate e pubblicate // TODO</button>
    </div>
  </div>


  <!-- SCELTA DI MODALITA' DI GIOCO -->
  <div class="row EditorSection" id="ChooseGameMode">
    <div class="card" onclick="CurrentWork.game_mode='SINGLE'; goToSection('ChooseAccessibility');">
      <img src="https://sites.google.com/site/battutememes/_/rsrc/1364322577314/home/omino%20bianco.jpg?height=200&width=189" class="card-img-top" alt="..." >
      <div class="card-body">
        <h5 class="card-title">Individuale</h5>
        <p class="card-text">In questa sessione di gioco si può giocare individualmente.</p>
      </div>
    </div>
    <div class="card" onclick="CurrentWork.game_mode='GROUP'; goToSection('ChooseAccessibility');">
      <img src="https://importanciadevivir.com/wp-content/uploads/2019/05/Sociedad-e-Individuo-1024x768.jpg" class="card-img-top" alt="...">
      <div class="card-body">
        <h5 class="card-title">Gruppo</h5>
        <p class="card-text">Tramite l'utilizzo di uno smartphone, i componenti del gruppo possono partecipare all'attività di gioco.
          Il gruppo è caratterizzato da 2 fino a 5 componenti.</p>
      </div>
    </div>
    <div class="card" onclick="CurrentWork.game_mode='CLASS'; goToSection('ChooseAccessibility');">
      <img src="https://www.merlinwizard.com/wp-content/uploads/gruppo-persone-stilizzato.jpg" class="card-img-top" alt="...">
      <div class="card-body">
        <h5 class="card-title">Classe</h5>
        <p class="card-text">Con classe si intende gruppi da 15 a 20 persone e l'utilizzo dell'attività è uguale nel caso del gruppo.</p>
      </div>
    </div>
  </div>


  <!-- SCELTA DI ACCESSIBILITA' -->
  <div class="EditorSection" id="ChooseAccessibility">
    <div>
      Clicca su una delle opzioni per partire
    </div>
    <div class="MainButtonGroup">
      <button class="btn btn-primary btn-lg btn-block" onclick="CurrentWork.ACCESSIBILITY = 1; goToSection('EditStory')"><strong>ACCESSIBILE</strong><br>Aggiungi il supporto per accessibilità (scelta consigliata)</button>
      <button class="btn btn-primary btn-lg btn-block" onclick="goToSection('EditStory')"><strong>NON ACCESSIBILE</strong><br>Non usare il supporto per accessibilità (scelta sconsigliata)</button>
    </div>
  </div>


  <!-- SCHERMATA DI EDITING DELLA STORIA -->
  <div class="EditorSection" id="EditStory">
    <div>
      Modifica le impostazioni generali della storia
    </div>
    <div>
      <button class="btn btn-primary btn-lg btn-block" id="EditStoryTitleButton" onclick="toggleTextInput( 'EditStoryTitle' );">Modifica titolo</button>
      <button class="btn btn-primary btn-lg btn-block">Modifica tema // TODO</button>
    </div>
    <div class="StageList" id="QuestList">
      <!-- questa lista viene aggiornata dinamicamente da un'apposita funzione - sulla base del lavoro attuale dell'autore -->
      <!-- forse è meglio non utilizzare una UL -->
      <ul>
        <li><button class="btn btn-secondary btn-lg StageButton AddStage" onclick="toggleIndexInput();">+</button></li>
      </ul>
    </div>
    <div>
      <button class="btn btn-primary btn-lg btn-block" onclick="">Modifica schermata dei settings // TODO</button>
      <button class="btn btn-primary btn-lg btn-block" onclick="">Visualizza anteprima // TODO</button>
    </div>
  </div>


  <!-- WIDGET DI INSERIMENTO TITOLO STORIA -->
  <div class="modal fade" id="EditStoryTitle" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Inserire il titolo della storia</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <input type="text" id="StoryTitleInput" name="StoryTitleInput">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Annulla</button>
          <button type="button" class="btn btn-primary" onclick="saveDataFragment( 'story_title', $( '#' + 'StoryTitleInput' ).val() ); $('#EditStoryTitle').modal('hide');">Salva</button>
        </div>
      </div>
    </div>
  </div>


  <!-- SCHERMATA DI EDITING DELLA QUEST -->
  <div class="EditorSection" id="EditQuest">
    <div>
      Modifica le impostazioni della quest
    </div>
    <div>
      <button class="btn btn-primary btn-lg btn-block" id="EditQuestTitleButton" onclick="toggleTextInput( 'EditQuestTitle' );">Modifica titolo</button>
      <button class="btn btn-primary btn-lg btn-block" onclick="">Modifica tema // TODO</button>
    </div>
    <div class="StageList" id="ActivityList">
      <!-- questa lista viene aggiornata dinamicamente da un'apposita funzione - sulla base del lavoro attuale dell'autore -->
      <!-- forse è meglio non utilizzare una UL -->
      <ul>
        <li><button class="btn btn-secondary btn-lg StageButton AddStage" onclick="toggleIndexInput();">+</button></li>
      </ul>
    </div>
    <div>
      <button class="btn btn-primary btn-lg btn-block" onclick="$('#RemovalAlert').text('Confermare la rimozione della quest?'); $('#RemoveStage').modal('toggle');">Elimina</button>
      <button class="btn btn-primary btn-lg btn-block" onclick="">Visualizza anteprima // TODO</button>
    </div>
  </div>


  <!-- WIDGET DI INSERIMENTO TITOLO QUEST -->
  <div class="modal fade" id="EditQuestTitle" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Inserire il titolo della quest</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <input type="text" id="QuestTitleInput" name="QuestTitleInput">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Annulla</button>
          <button type="button" class="btn btn-primary" id="SaveQuestName" onclick="saveDataFragment( 'quest_title', $( '#' + 'QuestTitleInput' ).val() ); $('#EditQuestTitle').modal('hide');">Salva</button>
        </div>
      </div>
    </div>
  </div>

  
  <!-- WIDGET DI INSERIMENTO INDICE -->
  <div class="modal fade" id="InsertStageIndex" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Scegliere l'opzione di inserimento dell'indice</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="custom-control custom-radio">
            <input type="radio" id="UseLastIndex" name="IndexSelectionRadio" class="custom-control-input">
            <label class="custom-control-label" for="UseLastIndex" onclick="$('#IndexInput').attr('disabled', true);">Usa l'ultimo indice</label>
          </div>
          <div class="custom-control custom-radio">
            <input type="radio" id="SelectIndex" name="IndexSelectionRadio" class="custom-control-input">
            <label class="custom-control-label" for="SelectIndex" onclick="$('#IndexInput').attr('disabled', false);">Usa un indice precedente</label>
          </div>
          <div class="form-check">
            <input type="number" id="IndexInput" name="IndexInput" min="0">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Annulla</button>
          <button type="button" class="btn btn-primary" onclick="insertNewStage();">Salva</button>
        </div>
      </div>
    </div>
  </div>


  <!-- WIDGET DI ELIMINAZIONE QUEST/ATTIVITA' -->
  <div class="modal fade" id="RemoveStage" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Attenzione!</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p id="RemovalAlert"></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Annulla</button>
          <button type="button" class="btn btn-primary" onclick="removeSelectedStage();">Elimina</button>
        </div>
      </div>
    </div>
  </div>


  <!-- SCHERMATA DI EDITING DELLE ATTIVITA' -->
  <div class="EditorSection" id="EditActivity">
    <div>
      Titolo sezione
    </div>
    <div>
      <button>Modifica testo attività</button>
      <button onclick="goToSection('EditAnswerField');">Modifica campo risposta</button>
      <button>Modifica programmazione dell'attività</button>
      <button>Modifica CSS</button>
    </div>
    <div>
      <button class="btn btn-primary btn-lg btn-block" onclick="$('#RemovalAlert').text('Confermare la rimozione della quest? La programmazione delle attività sarà compromessa e si renderà quindi necessaria una completa revisione della storia.'); $('#RemoveStage').modal('toggle');">Elimina</button>
      <button class="btn btn-primary btn-lg btn-block" onclick="">Visualizza anteprima // TODO</button>
    </div>
  </div>


  <!-- ANCORA IN SVILUPPO - NON TOCCARE -->
  <!-- SCHERMATA DI MODIFICA CAMPO RISPOSTA -->
  <div class="EditorSection" id="EditAnswerField">
    <div>
      Titolo sezione
    </div>

    <div>
      <div>Tipologia di input:</div>
      <div class="input-group">
        <input type="radio" name="QuestionType" id="QuestionType_Checklist" onclick="loadSection('EditAnswerField');">
        <label for="QuestionType_Checklist">Checklist</label>
        <input type="radio" name="QuestionType" id="QuestionType_Text" onclick="loadSection('EditAnswerField');">
        <label for="QuestionType_Text">Testo</label>
        <input type="radio" name="QuestionType" id="QuestionType_Number" onclick="loadSection('EditAnswerField');">
        <label for="QuestionType_Number">Numero</label>
      </div>
      <div class="alert alert-secondary" role="alert">
        In caso di spunta su un'altra opzione, i dati verranno resettati. Per non perdere il lavoro, ricarica la pagina.
      </div>
    </div>
    <!-- Input della stringa di testo che poi diventerà la "AnswerFieldDescription" -->
    <div>
      <label for="InsertAnswerFieldDescription">Indicazione per il giocatore:</label>
      <input type=text id="InsertAnswerFieldDescription">
    </div>
    <!-- Container dell'anteprima dell'Answer Field -->
    <div class="input-group" id="AnswerFieldPreview">
    </div>
    <!-- Sezione per il settaggio dell'AnswerField - non è soggetto a reload in caso il creator cambi opzione di input -->
    <div class="input-group" id="AnswerFieldSettings">
      <label for="AnswerScore">Punteggio per il corretto completamento dell'obiettivo</label>
      <input type="number" id="AnswerScore" min="0">
      <input type="checkbox" id="NeedEvaluation">
      <label for="NeedEvaluation">Richiesta valutazione</label>
      <input type="checkbox" id="InsertTimer">
      <label for="InsertTimer">Aggiungi il timer per la domanda</label>
      <label for="AnswerTimer">Limite di tempo (minuti) per il completamento dell'obiettivo</label>
      <input type="number" id="AnswerTimer" min="0.5" step="0.5">

      <script type="text/javascript">
        $( "#InsertTimer" ).click( function() {
          if ( this.checked )
            $( "#AnswerTimer" ).attr( "disabled", false );
          else
            $( "#AnswerTimer" ).attr( "disabled", true );
        });
      </script>
    </div>
    <button onclick="saveAnswerFieldSettings();">Salva</button>
  </div>
</body>
</html>

<!--
  Casi in cui bisogna ricaricare la pagina:
  * prima apertura -> campi tutti vuoti e magari un'opzione di input checkata di default
  * reload dopo un cambio di modalità input heck -> praticamente uguale alla prima apertura, ma i campi di settings rimangono invariati
  * seconda apertura -> compilazione in base a ciò che c'è nel json
-->