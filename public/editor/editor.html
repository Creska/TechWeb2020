<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
  <script src="editor.js"></script>
  <script src="animations.js"></script>
  <script src="editor_sections.js"></script>

  <script src="../player/test.js"></script> <!-- SOLO PER TEST -->

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  
  <link rel="stylesheet" href="cover.css">
  <link rel="stylesheet" href="editor.css">

  <title>Editor</title>
  <script>
    /* comunicazione con l'editor CSS */
    window.onload = function() {
      window.addEventListener( "message", (e) => {
        /*
        if ( CSS_Editor_Window == null || e.origin != CSS_Editor_Window.location.origin )
          return;*/

        switch ( e.data.event_type ) {
          case "ready":
            CSS_Editor_Window.postMessage( CSSdata.sheet, "*" );
            break;
          case "save":
            CSSdata = e.data.content;
            break;
        }
      });
    };

    /* abilita tutti i tooltips */
$(document).ready( function() {
      $('[data-toggle="tooltip"]').tooltip({
        trigger : 'hover'
      });
      $('[data-toggle="tooltip"]').mouseout( function() {
        $('[data-toggle="tooltip"]').tooltip({
          trigger : 'hover'
        });
      });
  $(document).ajaxStart(function(){
    $('#wait_modal').modal('show');
    //$("#loading").css("display", "block");
  });
  $(document).ajaxSuccess(function(){
    //$('#wait_modal').modal('hide');
    $('#wait_modal').modal('hide');
    //$("#loading").css("display", "none");
    $('#success_modal').modal('show');
    
  });
  $(document).ajaxError(function(){
    $('#wait_modal').modal('hide');
    //$("#loading").css("display", "none");
    $('#fail_modal').modal('show');
  });

    }); 
  </script>
</head>


<body class="text-center"> 
  <div id="loading" style="display: none; margin:auto;"><img src="https://media1.tenor.com/images/e6beafa79c010b6a2b4a7b705dd2bc59/tenor.gif?itemid=12479112" /> </div>
  <button onclick="$.get('/editor/porcodio', function(data, status){});">erore</button>
<!--<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#success_modal">
  Success
</button>-->
<div class="modal" id="wait_modal" data-keyboard="false" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
    <div class="modal-content">    
        <img style="width: 100%;" src="loading.gif" />              
    </div>
  </div>
</div>
<div class="modal fade" id="success_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
    <div class="modal-content">      
        <img style="width: 100%;" src="https://media1.tenor.com/images/d8fb39693bab23e2c3b4ee36317a36ee/tenor.gif?itemid=17836773" />                
      <div style='color:black' class="modal-body" >
        é andato tutto bene!
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="fail_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
    <div class="modal-content">      
        <img style="width: 100%;" src="https://media1.tenor.com/images/87d588d92e1b4decd302a96c265d7a39/tenor.gif?itemid=18634343" />               
      <div style='color:black' class="modal-body" >
        Qualcosa è andato storto, che cosa?
      </div>
    </div>
  </div>
</div>
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
    <div class="modal-content">
      
        <img style="width: 100%;" src="https://media.tenor.com/images/f6d1602a1c9e507b2cfe8e7c98faadd9/tenor.gif" />
                
      <div style='color:black' class="modal-body" >
        Attenzione! se torni nella home perderai tutto quello che non hai salvato, vuoi procedere lo stesso?
      </div>
      <div class="modal-footer">
        <button type="button" onclick="goToSection('MainMenu');" class="btn btn-primary" data-dismiss="modal">ok nigger</button>
      </div>
    </div>
  </div>
</div>

<div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">

  <header class="masthead mb-auto">
    <div class="inner">
      <h3 class="masthead-brand">STORY EDITOR</h3>
      <nav class="nav nav-masthead justify-content-center">
        <a class="nav-link" href="javascript: saveStory();" data-toggle="tooltip" data-placement="bottom" title="Salva la storia su server">
          <i class="far fa-save fa-2x"></i>
        </a>
        <a class="nav-link" href="javascript:Navbar('CSSEditor');" data-toggle="tooltip" data-placement="bottom" title="Modifica il CSS">
          <i class="fab fa-css3 fa-2x"></i>
        </a>
        <a class="nav-link" href="javascript:Navbar('Preview');" data-toggle="tooltip" data-placement="bottom" title="Visualizza l'anteprima">
          <i class="far fa-eye fa-2x"></i>
        </a>
        <a class="nav-link" href="javascript:Navbar('Home');" data-toggle="tooltip" data-placement="bottom" title="Torna alla home">
          <i class="fas fa-home fa-2x"></i>
        </a>
      </nav>
    </div>
  </header>


  <!-- WIDGET PER IL PROMPT DEL SALVATAGGIO -->
  <div class="modal fade" id="SavePrompt" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content bg-dark">
        <div class="modal-header">
          <h5 class="modal-title">Attenzione</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>Salvare prima di tornare al menu principale?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" onclick="$('#SavePrompt').modal('hide'); goToSection('MainMenu');">Ignora</button>
          <button type="button" class="btn btn-primary" onclick="/* TODO */">Salva</button>
        </div>
      </div>
    </div>
  </div>


  <!-- MENU PRINCIPALE -->
  <main role="main" class="btn-group-vertical inner cover mx-auto EditorSection" id="MainMenu">
    <h1 class="cover-heading SectionTitle">Benvenuto nello Story Editor!</h1>
    <p class="lead SectionHeader">Grazie a questo ambiente sarai in grado di creare una nuova storia, modificarne una già esistente, oppure gestire tutta la tua raccolta.</p>
    <div class="btn-group-vertical">
      <button class="btn btn-lg btn-secondary mb-3 rounded" onclick="MainMenu('NEWSTORY');" data-toggle="tooltip" data-placement="left" title="Crea una nuova storia"><i class="fas fa-plus"></i></button>
      <button class="btn btn-lg btn-secondary mb-3 rounded" onclick="MainMenu('');" data-toggle="tooltip" data-placement="right" title="Modifica una storia già esistente"><i class="fas fa-edit"></i></button>
      <button class="btn btn-lg btn-secondary mb-3 rounded" onclick="goToSection('Explorer');" data-toggle="tooltip" data-placement="left" title="Gestisci le storie salvate"><i class="fas fa-server"></i></button>
    </div>
  </main>


  <!-- SCELTA DI MODALITA' DI GIOCO -->
  <main class="inner cover mx-auto EditorSection" id="ChooseGameMode">
    <h1 class="cover-heading SectionTitle"><em>Storia senza nome</em></h1>
    <p class="lead SectionHeader">
      In questa sezione potrai compilare tutte le opzioni riguardo alla modalità di gioco.<br>
      Il numero di giocatori e quello dei dispositivi sono informazioni che serviranno all'applicazione server per gestire correttamente tutte le funzionalità.<br>
      Spuntando l'opzione di accessibilità, in fase di pubblicazione saranno effettuati controlli specifici per accertare che il gioco sia 100% accessibile.
    </p>

    <div>
      <p>Numero di giocatori:</p>
      <div class="card-deck">
        <div class="card rounded bg-secondary" id="a0" onclick="select(0);">
          <img src="../images/single.jpg" class="card-img-top" alt="..." >
          <div class="card-body">
            <h5 class="card-title">Single Player</h5>
          </div>
        </div>
        <div class="card rounded bg-secondary" id="a1" onclick="select(1);">
          <img src="../images/group.jpg" class="card-img-top" alt="...">
          <div class="card-body">
            <h5 class="card-title">Gruppo</h5>
            <p class="card-text">Gruppo unico da 2-5 membri</p>
          </div>
        </div>
        <div class="card rounded bg-secondary" id="a2" onclick="select(2);">
          <img src="../images/class.jpg" class="card-img-top" alt="...">
          <div class="card-body">
            <h5 class="card-title">Classe</h5>
            <p class="card-text">2-5 gruppi che giocano in parallelo</p>
          </div>
        </div>
      </div>
    </div>
  
    <div class="mt-5" style="display: none;" id="NumberOfDevices"> <!-- FORSE DA RIMUOVERE -->
      <p>Il numero di device di controllo si riferisce al numero di dispositivi che possono interagire con i campi risposta e la chat. Scegli se attribuire il controllo della storia ad un solo membro per gruppo, o ad ogni giocatore in esso:</p>

      <button id="a3" class="btn btn-secondary bg-secondary" onclick="CurrentWork.single_device = 1; select(3);">SINGOLO</button>
      <button id="a4" class="btn btn-secondary bg-secondary" onclick="CurrentWork.single_device = 0; select(4);">MULTIPLO</button>
    </div>
    
    <div class="mb-3">
      <p class="mt-5">Adesso scegli se rendere la storia accessibile (scelta consigliata) o meno:</p>
      <button id="a5" class="btn btn-secondary btn-lg mr-3 rounded-circle bg-secondary" onclick="select(5);"><i class="fab fa-accessible-icon"></i></button>
      <button id="a6" class="btn btn-secondary btn-lg rounded-circle bg-secondary" onclick="select(6);"><i class="fas fa-times"></i></button>
    </div>
    
    <div class="p-3 Save-Cancel">
      <button class="btn btn-success mb-3 mr-2 ml-2 rounded" onclick="saveGameModeSettings();">Salva</button>
      <button class="btn btn-secondary mb-3 mr-2 ml-2 rounded" onclick=back();>Annulla</button>
    </div>
  </main>


  <!-- GESTIONE DEL TITOLO DELLA STORIA E DELL'INSIEME DI QUEST -->
  <main role="main" class="inner cover EditorSection" id="EditStory">
    <h1 class="cover-heading SectionTitle"><em>Storia senza nome</em></h1>
    <p class="lead SectionHeader">
      Cambia il nome della storia e gestisci la lista delle quest.
    </p>

    <div class="input-group font-weight-bold">
      <div class="input-group-prepend">
        <span class="input-group-text bg-light">Titolo:</span>
      </div>
      <input type="text" id="StoryTitleInput" class="form-control" placeholder="Nuova Storia" onclick="change_color_option('#SaveStoryTitle', 'btn-success', 'btn-primary'); $('#SaveStoryTitle').text('Salva');">
      <div class="input-group-append">
         <button class="btn btn-success" id="SaveStoryTitle" type="button" onclick="save_title('story')">Salvato!</button>
      </div>
    </div>

    <div class="col-xs-12 alert alert-info text-justify" role="alert">
      <i class="fas fa-info"></i>
      <p>Di default cliccare su una quest ti permette di impostarne i parametri, tuttavia vi sono le modalità swap e cancel, rispettivamente per scambiare di posizione le quest ed  eliminarle.
      Per uscire da una mode basta cliccare nuovamente il relativo pulsante o selezionare un'altra mode. Infine onde prevenire spiacevoli incidenti, dovrai cliccare su una quest due volte per eliminarla.</p>
    </div>

    <div id="s_buttons_div" class=" p-3">
      <button class="btn btn-lg btn-secondary mb-3 mr-5 rounded" onclick="goToSection('ChooseGameMode');" data-toggle="tooltip" data-placement="left" title="Cambia la modalità di gioco">
        <i class="fas fa-cog"></i>
      </button>
      <button class="btn btn-lg btn-secondary mb-3 rounded SwapBtn" onclick="swap_mode()" data-toggle="tooltip" data-placement="bottom" title="Swap mode">
        <i class="fas fa-people-carry"></i>
      </button>
      <button id="s_new_button" class="btn btn-lg btn-secondary mb-3 mr-2 ml-2 rounded" onclick='$("#NewQuestWidget").removeClass("invisible");' data-toggle="tooltip" data-placement="top" title="Crea una nuova quest" ><i class="fas fa-plus"></i> </button>
      <button class="btn btn-lg btn-secondary mb-3 rounded CancelBtn" onclick="cancel_mode()" data-toggle="tooltip" data-placement="right" title="Cancel mode">
        <i class="fas fa-trash"></i>
      </button>
    </div>

    <div id="NewQuestWidget" class="input-group input-group-sm mb-3 font-weight-bold invisible">
      <div class="input-group-prepend">
        <span class="input-group-text bg-light">Titolo:</span>
      </div>
      <input type="text" class="form-control col-sm-5 " placeholder="Titolo della quest">
        <div class="input-group-append">
          <button class="btn btn-sm btn-primary" type="button" onclick='create_stuff("quest");create_card( $("#NewQuestWidget input").val() );$("#NewQuestWidget").addClass("invisible");'>Aggiungi</button>
          <button class="btn btn-sm btn-danger" type="button" onclick="$('#NewQuestWidget input').val('');$('#NewQuestWidget').addClass('invisible');">Annulla</button>
        </div>
    </div>

    <div class="CardGrid" id="QuestsGrid" >
    </div>
  </main>


  <!-- SCHERMATA DI EDITING DELLA QUEST -->
  <main class="inner cover EditorSection" id="EditQuest">
    <h1 class="cover-heading SectionTitle">TITOLO</h1>
    <p class="lead SectionHeader">
      Qui puoi cambiare il nome della quest e gestire la lista delle attività. Una <em>quest</em> è un insieme di attività. L'ordine delle quest è fisso per tutti i giocatori, indipendentemente da come viene completato l'ultimo esercizio.
    </p>

    <div class="input-group mb-5 font-weight-bold">
      <div class="input-group-prepend">
        <span class="input-group-text bg-light">Titolo:</span>
      </div>
      <input type="text" id="QuestTitleInput" class="form-control" placeholder="Nuova Quest" onclick="change_color_option('#SaveQuestTitle', 'btn-success', 'btn-primary'); $('#SaveQuestTitle').text('Salva');">
      <div class="input-group-append">
         <button class="btn btn-primary" id="SaveQuestTitle" type="button" onclick="save_title('quest')">Salva</button>
      </div>
    </div>

    <div id="q_buttons_div" class="p-3">
      <button class="btn btn-lg btn-secondary mb-3 rounded SwapBtn" onclick="swap_mode()" data-toggle="tooltip" data-placement="left" title="Swap mode">
        <i class="fas fa-people-carry"></i>
      </button>
      <button id="q_new_button" class="btn btn-lg btn-secondary mb-3 mr-2 ml-2 rounded" onclick='create_stuff("activity");create_card("");' data-toggle="tooltip" data-placement="top" title="Crea una nuova attività">
        <i class="fas fa-plus"></i>
      </button>
      <button class="btn btn-lg btn-secondary mb-3 rounded CancelBtn" onclick="cancel_mode()" data-toggle="tooltip" data-placement="right" title="Cancel mode">
        <i class="fas fa-trash"></i>
      </button>
    </div>

    <div class="CardGrid" id="ActivitiesGrid">
    </div>

    <button type="button" class="btn bg-secondary rounded BackBtn" onclick="back()">
      <i class="fas fa-long-arrow-alt-left fa-2x mr-3 ml-3"></i>
    </button>
  </main>


  <!-- SCHERMATA DI EDITING DELLE ATTIVITA' -->
  <main class="inner cover EditorSection" id="EditActivity">
    <header>
      <small>QUEST</small>
      <h1 class="cover-heading SectionTitle">TITOLO</h1>
    </header>
    
    <p class="lead SectionHeader">
      In questa sezione potrai creare e modificare il testo e la programmazione dell'attività.
    </p>

    <div class="p-3">
      <button id="FinalStageBtn" class="btn btn-lg btn-secondary mb-3 rounded" onclick="setFinalActivity();" data-toggle="tooltip" data-placement="left" title="Marca attività come finale">
        <i class="fas fa-flag-checkered"></i>
      </button>
      <button class="btn btn-lg btn-secondary mb-3 mr-2 ml-2 rounded" onclick="goToSection('EditAnswerField')" data-toggle="tooltip" data-placement="bottom" title="Modifica il campo di risposta">
        <i class="fas fa-tasks"></i>
      </button>
      <button class="btn btn-lg btn-secondary mb-3 rounded" onclick="goToSection('SetAnswerOutcome')" data-toggle="tooltip" data-placement="right" title="Modifica la progressione dell'attività">
        <i class="fas fa-route"></i>      
      </button>
    </div>
    <div class="col-xs-12 alert alert-info text-justify" role="alert">
      <i class="fas fa-info"></i>
      <p>Se marchi questa attività come finale, segnalerai che essa verrà setttata il punto d'arrivo del gioco. Di conseguenza non vi sarà alcuna tappa successiva.Attenzione però! Spetta all'autore fare in modo che tutti i possibili percorsi di gioco convergano ad essa.<br>
      Cliccando sulla seconda icona potrai modificare il campo risposta, mentre sulla terza andrai a gestire il sistema che attribuirà, ad ogni possibile risposta, la tappa a cui il giocatore verrà condotto.</p>
    </div>

    <div id="q_buttons_div" class="p-3">
      <button class="btn btn-lg btn-secondary mb-3 rounded SwapBtn" onclick="swap_mode()" data-toggle="tooltip" data-placement="left" title="Swap mode">
        <i class="fas fa-people-carry"></i>
      </button>
      <button class="btn btn-lg btn-secondary mb-3 mr-2 ml-3 rounded" onclick='create_stuff("TextParagraph");create_card("[vuoto]");' data-toggle="tooltip" data-placement="top" title="Aggiungi paragrafo di testo">
        <i class="fas fa-paragraph"></i>
      </button>
      <button class="btn btn-lg btn-secondary mb-3 mr-3 rounded" onclick='create_stuff("Gallery");create_card("GALLERY");' data-toggle="tooltip" data-placement="top" title="Aggiungi galleria di immagini">
        <i class="far fa-images"></i>
      </button>
      <button class="btn btn-lg btn-secondary mb-3 rounded CancelBtn" onclick="cancel_mode()" data-toggle="tooltip" data-placement="right" title="Cancel mode">
        <i class="fas fa-trash"></i>
      </button>
    </div>

    <div class="CardGrid" id="ParagraphsGrid">
    </div>

    <button type="button" class="btn bg-secondary rounded BackBtn" onclick="back()">
      <i class="fas fa-long-arrow-alt-left fa-2x mr-3 ml-3"></i>
    </button>
  </main>


  <!-- SCHERMATA DI MODIFICA CAMPO RISPOSTA -->
  <main class="inner cover EditorSection" id="EditAnswerField">
    <header>
      <small>QUEST</small>
      <h1 class="cover-heading SectionTitle">TITOLO</h1>
    </header>
    <p class="lead SectionHeader">
      In questa sezione potrai creare e modificare il campo risposta dell'attività.<br>
      Puoi scegliere tra tre diversi tipi di input e una piccola serie di opzioni per regolamentarne il funzionamento.
    </p>

    <div id="AFtype">
      <h4 class="mb-3">Tipologia di input</h4>
      <div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="QuestionType" id="QuestionType_Checklist">
          <label class="form-check-label" for="QuestionType_Checklist">Checklist</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="QuestionType" id="QuestionType_Text">
          <label class="form-check-label" for="QuestionType_Text">Testo</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="QuestionType" id="QuestionType_Number">
          <label class="form-check-label" for="QuestionType_Number">Numero</label>
        </div>

        <div class="mt-5" id="ChecklistPreview">
          <h4 class="mb-3">Risposte selezionabili</h4>

          <ul class="mb-3"></ul>

          <div id="AddAnswerOption" class="input-group input-group-sm font-weight-bold">
            <div class="input-group-prepend">
              <span class="input-group-text bg-light">Aggiungi opzione:</span>
            </div>
            <input type="text" class="form-control col-sm-5" placeholder="Risposta">
            <div class="input-group-append">
              <button class="btn btn-sm btn-primary" type="button" onclick="addAnswerOption( $('#AddAnswerOption input').val().trim() );">Aggiungi</button>
              <button class="btn btn-sm btn-danger" type="button" onclick="$('#AddAnswerOption input').val('');">Annulla</button>
            </div>
          </div>
        </div>

        <script>
          $("#EditAnswerField input[name='QuestionType']").on("change", function() {
            if ( $("#QuestionType_Checklist").prop("checked") )
		          $( "#ChecklistPreview" ).fadeIn();
	          else
		          $( "#ChecklistPreview" ).fadeOut();
          });
        </script>
      </div>
    </div>
    
    <div class="w-100 mt-5" id="AnswerFieldSettings">
      <h4 class="mb-3">Opzioni del campo risposta</h4>
      <div class="row w-100">
        <div class="col-11">
          <div class="input-group m-1">
            <div class="input-group-prepend">
              <div class="input-group-text">Tip</div>
            </div>
            <input type="text" class="form-control" id="InsertAnswerFieldDescription" id="AnswerScore" placeholder="Indicazione">
          </div>
       </div>

        <div class="col-1">
          <span class="badge badge-pill badge-light" data-toggle="tooltip" data-placement="left" title="Eventuale indicazione utile per il giocatore">
            <i class="fas fa-info"></i>
          </span>
        </div>
      </div>

      <div class="row w-100">
        <div class="col-11">
          <div class="input-group m-1">
            <div class="input-group-prepend">
              <span class="input-group-text">Valutazione live</span>
            </div>
            <div class="input-group-append">
              <div class="input-group-text">
                <input type="checkbox" id="NeedEvaluation">
              </div>
            </div>
          </div>
        </div>

        <div class="col-1">
          <span class="badge badge-pill badge-light" data-toggle="tooltip" data-placement="left" title="Se spuntata, indica che la valutazione verrà chiesta automaticamente al valutatore, al momento dell'invio della risposta">
            <i class="fas fa-info"></i>
          </span>
        </div>
      </div>
      
      <div class="row w-100">
        <div class="col-11">
          <div class="input-group m-1">
            <div class="input-group-prepend">
              <span class="input-group-text">Attivazione help timer</span>
            </div>
            <div class="input-group-append">
              <div class="input-group-text">
                <input type="checkbox" id="InsertTimer">
              </div>
            </div>
          </div>
        </div>

        <div class="col-1">
          <span class="badge badge-pill badge-light" data-toggle="tooltip" data-placement="left" title="Attiva il timer alla cui scadenza viene segnalato al valutatore che il player ha superato il tempo previsto per l'attività in esecuzione">
            <i class="fas fa-info"></i>
          </span>
        </div>
      </div>

      <div class="row w-100">
        <div class="col-11">
          <div class="input-group m-1">
            <div class="input-group-prepend">
              <span class="input-group-text">Tempo previsto (min)</span>
            </div>
            <input type="number" class="form-control" id="AnswerTimer" placeholder="1" min="1">
          </div>
        </div>
      
        <div class="col-1">
          <span class="badge badge-pill badge-light" data-toggle="tooltip" data-placement="left" title="Valore dell'help timer">
            <i class="fas fa-info"></i>
          </span>
        </div>
      </div>
          

      <script>
        $( "#InsertTimer" ).click( function() {
          if ( this.checked )
            $( "#AnswerTimer" ).attr( "disabled", false );
          else
            $( "#AnswerTimer" ).attr( "disabled", true );
        });
      </script>
    </div>
  
    <div class="p-3 Save-Cancel">
      <button class="btn btn-success mb-3 mr-2 ml-2 rounded" onclick="saveAnswerFieldSettings();">Salva</button>
      <button class="btn btn-secondary mb-3 mr-2 ml-2 rounded" onclick="back();">Annulla</button>
    </div>
  </main>


  <!-- SCHERMATA PER LA MODIFICA DELLA PROGRESSIONE DELL'ATTIVITA' -->
  <main class="inner cover EditorSection" id="SetAnswerOutcome">
    <script>
      // attiva/disattiva i number input in base alla spunta sulla checkbox di passaggio alla quest successiva
      $(document).on( "click", ".OutcomesTable input[type='checkbox']", function() {
        if ( $(this).prop("checked") )
          $($(this).parent().next().children().first()).attr("disabled", true);
        else
          $($(this).parent().next().children().first()).attr("disabled", false);
      });
    </script>
    
    <header>
      <small>QUEST</small>
      <h1 class="cover-heading SectionTitle">TITOLO</h1>
    </header>
    <p class="lead SectionHeader">
      In questa sezione potrai stabilire gli <em>outcome</em> di ogni attività. Per <em>outcome</em> si intende la corrispondenza tra una risposta e la rispettiva conseguenza. Graze all'uso della tabella, sarai in grado di stabilire i reindirizzamenti per ogni specifica risposta, che quindi potrà condurre ad un'altra attività o alla quest successiva.<br>
      <small>Si tenga presente che la verifica della risposta effettuata dall'applicazione di gioco è case-sensitive.</small>
    </p>

    <div id="ChooseActivityType" class="p-3">
      <h4 class="mb-3">Tipologia attività</h4>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="ActivityType" id="ActivityType_Reading">
        <label class="form-check-label" for="ActivityType_Reading">Sola lettura</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="ActivityType" id="ActivityType_Answer">
        <label class="form-check-label" for="ActivityType_Answer">Interattiva</label>
      </div>
    </div>

    <div class="mt-5" id="ReadingActivity">
      <h4 class="mb-3">Programmazione attività</h4>
      <table class="w-100 mt-3 OutcomesTable">
        <tr class="mb-2">
      		<th>Risposta</th>
      		<th>Passa alla quest successiva</th>
      		<th>Passa ad attività specifica</th>
        </tr>
        <tr>
          <td><em>Sola lettura</em></td>
          <td><input type="checkbox"></td>
          <td><input type="number" placeholder="0" size="6" min="0"></td>
        </tr>
      </table>
    </div>

    <div class="mt-5" id="AnswerActivity">
      <div class="mb-5" id="AnswerFieldRecap"></div>

      <h4>Programmazione attività</h4>

      <table class="w-100 mt-3 OutcomesTable">
        <tr class="mb-2">
      		<th>Risposta</th>
      		<th>Passa alla quest successiva</th>
          <th>Passa ad attività specifica</th>
          <th>Rimuovi</th>
        </tr>
        <tr>
          <td><em>default</em></td>
          <td><input type="checkbox"></td>
          <td><input type="number" placeholder="0" size="6" min="0"></td>
          <td></td>
        </tr>
      </table>
      
      <div id="AddOutcomeWidget" class="input-group input-group-sm font-weight-bold mb-3 mt-5">
        <div class="input-group-prepend">
          <span class="input-group-text bg-light">Aggiungi outcome:</span>
        </div>
        <input type="text" class="form-control col-sm-5" placeholder="Risposta">
        <div class="input-group-append">
          <button class="btn btn-sm btn-primary" type="button" onclick="addOutcome($('#AddOutcomeWidget input').val().trim()); $('#AddOutcomeWidget input').val('')">Aggiungi</button>
          <button class="btn btn-sm btn-danger" type="button" onclick="$('#AddOutcomeWidget input').val('');">Annulla</button>
        </div>
      </div>
    </div>

    <script>
      $("#ChooseActivityType input[name='ActivityType']").on("change", function() {
        if ( $("#ActivityType_Reading").prop("checked") ) {
          $( "#ReadingActivity" ).fadeIn();
          $( "#AnswerActivity" ).fadeOut();
        }
        else if ( $("#ActivityType_Answer").prop("checked") ) {
          $( "#AnswerActivity" ).fadeIn();
          $( "#ReadingActivity" ).fadeOut();
        }
      });
    </script>

    <div class="p-3 Save-Cancel">
      <button class="btn btn-success mb-3 mr-2 ml-2 rounded" onclick="saveOutcomes();">Salva</button>
      <button class="btn btn-secondary mb-3 mr-2 ml-2 rounded" onclick="back();">Annulla</button>
    </div>
  </main>


  <!-- SCHERMATA DI MODIFICA TESTO -->
  <main class="inner cover EditorSection" id="EditText">
    <header>
      <small>QUEST</small>
      <h1 class="cover-heading SectionTitle">TITOLO</h1>
    </header>
    <p class="lead SectionHeader">
      Aggiungi un nuovo paragrafo al testo dell'attività.
    </p>

    <textarea id="TextParInput" rows="15" cols="50" placeholder="Inserisci un testo..."></textarea>

    <div class="p-3 Save-Cancel">
      <button class="btn btn-success mb-3 mr-2 ml-2 rounded" onclick="saveTextParagraph();">Salva</button>
      <button class="btn btn-secondary mb-3 mr-2 ml-2 rounded" onclick="back();">Annulla</button>
    </div>
  </main>


  <!-- SCHERMATA DI MODIFICA GALLERY -->
  <main class="inner cover EditorSection" id="EditGallery">
    <header>
      <small>QUEST</small>
      <h1 class="cover-heading SectionTitle">TITOLO</h1>
    </header>
    <p class="lead SectionHeader">
      Aggiungi una sezione contenente una o più immagini.<br>
      Nel caso sia stata scelta l'opzione di accessibilità, è obbligatorio inserire una descrizione per ogni immagine. Anche in caso contrario, tuttavia, inserire una didascalia è <em>caldamente consigliato</em>.
    </p>

    <div class="col-xs-12 alert alert-warning text-justify" role="alert">
      <i class="fas fa-exclamation-triangle"></i>
      <p>Formati accettati: JPG, PNG.<br>Files di tipo differente non saranno caricati.</p>
    </div>

    <div class="container" id="GalleryPreview"></div>

    <div class="p-3 Save-Cancel">
      <button class="btn btn-secondary mb-3 mr-2 ml-2 rounded" onclick="$('#UploadImg').trigger('click');" data-toggle="tooltip" data-placement="left" title="Aggiungi immagini">
        <i class="fas fa-plus"></i>
      </button>
      <input type="file" id="UploadImg" style="display:none;" multiple>
      <button class="btn btn-success mb-3 mr-2 ml-2 rounded" onclick="saveImageGallery();">Salva</button>
      <button class="btn btn-secondary mb-3 mr-2 ml-2 rounded" onclick="back();">Annulla</button>
    </div>

    <script>
      const fileSelector = document.getElementById("UploadImg");
      fileSelector.addEventListener("change", function(event) {
        for ( pic of event.target.files ) {
          switch ( getFileExtension(pic.name) ) {
            case "jpg":
            case "JPG":
            case "jpeg":
            case "JPEG":
            case "png":
            case "PNG":
              if (pic) addImage(pic, true);
          }
        }
      });
    </script>
  </main>

  <main role="main" class="inner cover EditorSection " id="Explorer">
    <a class="nav-link" href="javascript:goToSection('MainMenu')" data-toggle="tooltip" data-placement="bottom" title="Torna alla home">
      <i class="fas fa-home fa-2x"></i>
    </a>
     <!-- <p style="border: solid 1px; " ondrop="drop(event)" ondragover="allowDrop(event)">
        <img src="loli.png" draggable='true' ondragstart="drag(event)" id="drag1" width="20%" height="30%">
      </p>
      <p style="border: solid 1px; " ondrop="drop(event)" ondragover="allowDrop(event)">
        <img src="loli.png" draggable='true' ondragstart="drag(event)" id="drag2" width="20%" height="30%">
      </p>  -->
      <style>
        .grid-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    
    grid-gap: 20px;
}
.grido {
  display: grid;
  grid-template-rows: 1fr 1fr;
}
      </style> 
  <div class="grido">
    <div class="card "  style="opacity: 0; cursor: default;" >
      <div class="card-body text-center">
        <p class="card-text">1</p>
      </div>
    </div>
  <div class=" container border border-white rounded mb-3 "   ondragover="allowDrop(event)" ondrop="drop(event)" ondragleave="this.classList.remove('border-primary');this.classList.add('border-white');">
    <div class="card-deck mb-2">
           
    </div> 
  </div>
  </div>
  <div class="grid-container">
    <div class="container border border-white rounded"  ondragover="allowDrop(event)" ondrop="drop(event)" ondragleave="this.classList.remove('border-primary');this.classList.add('border-white');">
      <div class="card-deck mb-2"  >
        <div class="card bg-danger" draggable='true' ondrop='event.preventDefault();' ondragstart="drag(event)" id="drag0">
          <div class="card-body text-center">
            <p class="card-text">1</p>
          </div>
        </div>
        <div class="card bg-danger" draggable='true' ondrop='event.preventDefault()' ondragstart="drag(event)" id="drag1">
          <div class="card-body text-center">
            <p class="card-text">2</p>
          </div>
        </div>
      </div> 
      <div class="card-deck mb-2"  >
        <div class="card bg-danger" draggable='true' ondrop='event.preventDefault()' ondragstart="drag(event)" id="drag2">
          <div class="card-body text-center">
            <p class="card-text">3</p>
          </div>
        </div>
        <div class="card bg-danger" draggable='true' ondrop='event.preventDefault()' ondragstart="drag(event)" id="drag3">
          <div class="card-body text-center">
            <p class="card-text">4</p>
          </div>
        </div>
      </div>    
    </div>       
      
    <div class="container border border-white rounded" ondragover="allowDrop(event)" ondrop="drop(event)" ondragover="allowDrop(event)" ondrop="drop(event)" ondragleave="this.classList.remove('border-primary');this.classList.add('border-white');"> 
      <div class="card-deck mb-2" >
        <div class="card bg-success" draggable='true' ondrop='event.preventDefault()' ondragstart="drag(event)" id="drag6">
          <div class="card-body text-center">
            <p class="card-text">1</p>
          </div>
        </div>
        <div class="card bg-success" draggable='true' ondrop='event.preventDefault()' ondragstart="drag(event)" id="drag7">
          <div class="card-body text-center">
            <p class="card-text">2</p>
          </div>
        </div>
      </div>
      <div class="card-deck mb-2"  >
        <div class="card bg-success" draggable='true' ondrop='event.preventDefault()' ondragstart="drag(event)" id="drag8">
          <div class="card-body text-center">
            <p class="card-text">3</p>
          </div>
        </div>
        <div class="card bg-success" draggable='true' ondrop='event.preventDefault()' ondragstart="drag(event)" id="drag9">
          <div class="card-body text-center">
            <p class="card-text">4</p>
          </div>
        </div>
      </div>          
    </div>


  </div>
  </main>
  <!--
  <div class="EditorSection" id="TestSection">
    SEZIONE USATA PER DEBUGGING
  </div>
  -->
  
  
  <footer class="mastfoot mt-auto">
    <div class="inner small">
      <p> a cura di <a href="../about/team.html" target="_blank">studenti</a> dell'<a href="https://www.unibo.it/it">Alma Mater Studiorum</a>, 2020 </p>
    </div>
  </footer>

</div>
</body>

</html>
<!--
third button concept:
  there are three sections which represent a trash can, a 
  published stories container and an unpublished and consistent stories
  container. Every story, which is nothing but a card with the story's
  title within, can be dragged to any section any time, then there's a
  button to "stage/commit and push" the changes. when the saving is occuring
  there's a loading gif, then a return message is shown together with another
  gif(ofc) with a satisfied loli or a sad/angry one, representing success and 
  failure respectively. In the latter case all the errors are shown and associated 
  with the respective story in a feedback section at the bottom of the page, which
  is cleared everytime a saving is requested. Finally the three main sections are
  re-created to show the current stories' situation.
-->
